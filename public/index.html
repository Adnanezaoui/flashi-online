<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>POLO - Ù„Ø¹Ø¨Ø© Ø§Ø®ØªÙ„Ø§Ù Ø§Ù„ØµÙˆØ±</title>
<style>
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Cairo', sans-serif; }
    body { background:#0a1c23; color:white; display:flex; justify-content:center; align-items:center; min-height:100vh; }
    #loginPage, #gamePage { width:100%; max-width:1200px; text-align:center; }
    #loginPage input { padding:15px 20px; border-radius:40px; border:none; margin:10px; font-size:18px; }
    #loginPage button { padding:15px 40px; border-radius:40px; border:none; font-size:20px; background:#fecb57; cursor:pointer; }
    #loginError { color:red; margin-top:10px; }
    .game-wrapper { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin-top:20px; }
    .game-info, .leaderboard { background:#1f5568; padding:20px; border-radius:20px; margin:10px; }
    .game-info { flex:2; }
    .leaderboard { flex:1; min-width:250px; }
    .game-canvas { width:320px; height:220px; margin:10px auto; border:4px solid #97d4d4; border-radius:20px; overflow:hidden; background:#fff; cursor:pointer; }
    .game-canvas img { width:100%; height:100%; object-fit:cover; }
    .btn { padding:10px 25px; border-radius:40px; border:none; font-size:18px; background:#fdca40; cursor:pointer; margin:5px; }
    .score-board { margin-top:20px; background:#0d3a47; padding:15px; border-radius:20px; }
    ul { list-style:none; padding:0; text-align:right; }
</style>
</head>
<body>

<!-- ØµÙØ­Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div id="loginPage">
    <h1 style="font-size:50px; margin-bottom:20px;">ğŸ”¥ POLO ğŸ”¥</h1>
    <input type="text" id="playerNameInputLogin" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ"><br>
    <input type="password" id="passwordInputLogin" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"><br>
    <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
    <p id="loginError"></p>
</div>

<!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© -->
<div id="gamePage" style="display:none;">
    <h2>Ù…Ø±Ø­Ø¨Ø§ Ø¨ÙƒØŒ <span id="playerNameDisplay">Ø²Ø§Ø¦Ø±</span></h2>
    <div style="margin:20px;">
        <button id="startGameBtn" class="btn">â–¶ï¸ Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© (Ù„Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·)</button>
    </div>

    <div class="game-wrapper">
        <div class="game-info">
            <div>â³ ÙˆÙ‚Øª Ø§Ù„Ø¬ÙˆÙ„Ø©: <span id="timer">15</span> Ø«Ø§Ù†ÙŠØ©</div>
            <div>ğŸ† Ù†Ù‚Ø§Ø·Ùƒ: <span id="playerScore">0</span></div>
            <div>ğŸ”¢ Ø¬ÙˆÙ„Ø©: <span id="currentRound">1</span></div>
            <div>ğŸ‘¥ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†:</div>
            <ul id="currentPlayers"></ul>
        </div>
        <div>
            <div class="game-canvas"><img id="leftImage" src="" alt="ØµÙˆØ±Ø© Ø£"></div>
            <div class="game-canvas"><img id="rightImage" src="" alt="ØµÙˆØ±Ø© Ø¨"></div>
        </div>
        <div class="leaderboard">
            <h3>ğŸ… ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¬ÙˆÙ„Ø©</h3>
            <ul id="leaderboardList"></ul>
        </div>
    </div>
    <div id="roundResults" class="score-board" style="display:none;"></div>
</div>

<script>
// ------------------------------------------------------
// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
// ------------------------------------------------------
let players = {}; // ÙƒÙ„ Ù„Ø§Ø¹Ø¨: name -> score
let playerName = '';
let isAdmin = false;

let totalRounds = 50;
let currentRound = 0;
let roundTime = 15;
let roundInterval = null;
let waitingTimeout = null;

let images = [
    { left:"https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&h=300", right:"https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&h=300" },
    { left:"https://images.unsplash.com/photo-1526481280696-3f671bf5f0a2?auto=format&fit=crop&w=400&h=300", right:"https://images.unsplash.com/photo-1526481280696-3f671bf5f0a2?auto=format&fit=crop&w=400&h=300" },
    { left:"https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=400&h=300", right:"https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=400&h=300" },
    { left:"https://images.unsplash.com/photo-1472214103451-9374bd1c798e?auto=format&fit=crop&w=400&h=300", right:"https://images.unsplash.com/photo-1472214103451-9374bd1c798e?auto=format&fit=crop&w=400&h=300" },
    { left:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=400&h=300", right:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=400&h=300" }
];

// ------------------------------------------------------
// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
// ------------------------------------------------------
function login() {
    const name = document.getElementById('playerNameInputLogin').value.trim();
    const password = document.getElementById('passwordInputLogin').value.trim();
    const errorP = document.getElementById('loginError');
    if(password !== "POLO FAMILY") { errorP.innerText="âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©"; return; }
    if(name==='') { errorP.innerText="âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…"; return; }

    playerName = name;
    if(!players[playerName]) players[playerName] = 0; // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨
    updateCurrentPlayers();

    document.getElementById('playerNameDisplay').innerText = playerName;

    document.getElementById('loginPage').style.display='none';
    document.getElementById('gamePage').style.display='block';
}

// ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†
function updateCurrentPlayers() {
    let list = document.getElementById('currentPlayers');
    list.innerHTML = '';
    Object.keys(players).forEach(p=>{
        list.innerHTML += `<li>${p}</li>`;
    });
}

// ------------------------------------------------------
// Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø© (Ù„Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·)
// ------------------------------------------------------
document.getElementById('startGameBtn').addEventListener('click', function(){
    if(!isAdmin){ isAdmin = true; alert("âœ… Ø£Ù†Øª Ø§Ù„Ø£Ø¯Ù…Ù†. Ø³ÙŠØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø§Øª."); }
    nextRound();
});

// ------------------------------------------------------
// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬ÙˆÙ„Ø©
// ------------------------------------------------------
function nextRound(){
    document.getElementById('roundResults').style.display='none';
    currentRound++;
    document.getElementById('currentRound').innerText = currentRound;

    let imgIndex = Math.floor(Math.random()*images.length);
    document.getElementById('leftImage').src = images[imgIndex].left;
    document.getElementById('rightImage').src = images[imgIndex].right;

    let timeLeft = roundTime;
    document.getElementById('timer').innerText = timeLeft;

    if(roundInterval) clearInterval(roundInterval);
    roundInterval = setInterval(()=>{
        timeLeft--;
        document.getElementById('timer').innerText = timeLeft;
        if(timeLeft<=0){
            clearInterval(roundInterval);
            endRound();
        }
    },1000);
}

// ------------------------------------------------------
// Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø© ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
// ------------------------------------------------------
function endRound(){
    // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù†Ù‚Ø§Ø· Ù„ÙƒÙ„ Ù„Ø§Ø¹Ø¨ Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ (ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø®ØªÙ„Ø§Ù)
    for(let p in players){
        players[p] += Math.floor(Math.random()*10+1);
    }

    // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
    let leaderboardArr = Object.keys(players).map(name=>({name:name, score:players[name]}));
    leaderboardArr.sort((a,b)=>b.score-a.score);

    // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø¬Ù…ÙŠØ¹ Ø¨Ø¹Ø¯ Ø§Ù„Ø¬ÙˆÙ„Ø©
    let resultsDiv = document.getElementById('roundResults');
    let html=`<h3>ğŸ† Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¬ÙˆÙ„Ø© ${currentRound}</h3>`;
    leaderboardArr.forEach((pl,i)=>{
        html += `${i+1}. ${pl.name} - ${pl.score} Ù†Ù‚Ø§Ø·<br>`;
    });
    resultsDiv.innerHTML = html;
    resultsDiv.style.display='block';

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
    let lbHtml='';
    leaderboardArr.forEach(pl=>{
        lbHtml += `<li>${pl.name} - ${pl.score}</li>`;
    });
    document.getElementById('leaderboardList').innerHTML = lbHtml;

    // Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± 5 Ø«ÙˆØ§Ù†ÙŠ Ø«Ù… Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
    waitingTimeout = setTimeout(nextRound,5000);
}
</script>
</body>
</html>
