<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„Ø¹Ø¨Ø© Ø§Ø®ØªÙ„Ø§Ù Ø§Ù„ØµÙˆØ± - Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
<style>
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Cairo','Segoe UI',sans-serif; }
    body { background: linear-gradient(145deg,#0a1c23 0%,#06242e 100%); display:flex; justify-content:center; align-items:center; min-height:100vh; padding:15px; }
    .game-wrapper { max-width:1600px; width:100%; display:flex; gap:20px; flex-wrap:wrap; justify-content:center; }
    .main-game { flex:2; min-width:700px; background:#1f5568; border-radius:60px 60px 40px 40px; padding:30px 25px; box-shadow:0 25px 35px rgba(0,0,0,0.7); border:3px solid #6ec3d4; }
    .sidebar { flex:1; min-width:350px; display:flex; flex-direction:column; gap:20px; }
    /* ... (keep your other styles as before) ... */
</style>
</head>
<body>

<!-- POLO Login -->
<div id="poloLoginPage" style="text-align:center; color:white;">
    <h1 style="font-size:60px; margin-bottom:30px;">ğŸ”¥ POLO ğŸ”¥</h1>
    <input type="text" id="poloPlayerName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ" style="padding:15px 25px; border-radius:40px; border:none; font-size:18px; margin-bottom:15px; width:250px;"><br>
    <input type="password" id="poloPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="padding:15px 25px; border-radius:40px; border:none; font-size:18px; width:250px;"><br><br>
    <button id="poloEnterBtn" style="padding:15px 40px; border-radius:40px; border:none; font-size:20px; background:#fecb57; cursor:pointer;">Ø¯Ø®ÙˆÙ„</button>
    <p id="poloError" style="color:red; margin-top:15px;"></p>
</div>

<!-- Main Game -->
<div class="game-wrapper" id="mainGame" style="display:none;">
    <!-- Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="main-game">
        <div class="flashi-header">
            <div class="logo">ğŸ¯ Ø§Ø®ØªÙ„Ø§Ù Ø§Ù„ØµÙˆØ± <span>Flashi</span></div>
            <div style="display:flex; align-items:center; gap:15px;">
                <span id="gameStatusBadge" class="game-status status-active">ğŸŸ¢ Ù†Ø´Ø·</span>
                <span class="room-code" id="roomCodeDisplay"></span>
            </div>
        </div>
        <div class="player-panel">
            <div class="name-field">
                <span style="font-size:28px;">ğŸ‘¤</span>
                <input type="text" id="playerNameInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ" value="Ø²Ø§Ø¦Ø±">
            </div>
            <button id="enterGameBtn" class="btn">ğŸšª Ø¯Ø®ÙˆÙ„</button>
        </div>
        <div class="game-info">
            <span>ğŸ‘¥ Ø§Ù„Ø²Ø§Ø¦Ø±ÙŠÙ†: <span id="visitorCount">1</span></span>
            <span>ğŸ® ØµÙˆØ±Ø©: <span id="imageCounter">1/200</span></span>
            <span>â­ Ù†Ù‚Ø§Ø·Ùƒ: <span id="playerTotalScore">0</span></span>
        </div>
        <div class="images-row">
            <div class="img-holder">
                <p>ğŸ–¼ï¸ Ø§Ù„ØµÙˆØ±Ø© Ø£</p>
                <div class="game-canvas"><img id="leftImage" src="" alt="Left Image"></div>
            </div>
            <div class="img-holder">
                <p>ğŸ–¼ï¸ Ø§Ù„ØµÙˆØ±Ø© Ø¨</p>
                <div class="game-canvas"><img id="rightImage" src="" alt="Right Image"></div>
            </div>
        </div>
        <div class="score-timer">
            <div class="score-box"><span>ğŸ†</span> <span id="scoreDisplay">0</span></div>
            <div class="timer-box"><span>â³</span> <span id="timerDisplay">0:20</span></div>
            <div class="players-count"><span>ğŸ¯</span> <span id="differencesLeft">5</span></div>
        </div>
        <div id="messageBox" class="message-area">â° ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± ÙŠØ§ <span id="playerNameSpan">Ø²Ø§Ø¦Ø±</span> Ø­ØªÙ‰ ØªØ¨Ø¯Ø£ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</div>
    </div>
    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ ... ÙŠÙ…ÙƒÙ†Ùƒ ÙˆØ¶Ø¹ Ø§Ù„Ø´ÙŠÙØ±Ø© ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© -->
</div>

<script>
    // ------------------------------------------------------
    // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
    // ------------------------------------------------------
    let playerName = "Ø²Ø§Ø¦Ø±";
    let currentScore = 0, totalScore = 0, timeSeconds = 20;
    let gameActive = false, gamePaused = false;
    let foundDiffCount = 0, currentLevel = 0;
    let timerIntervalId = null, nextRoundTimeout = null;

    const levels = generateImageUrls();
    const TOTAL_IMAGES = levels.length;

    // Ø¹Ù†Ø§ØµØ± DOM
    const leftImage = document.getElementById('leftImage');
    const rightImage = document.getElementById('rightImage');
    const nameInput = document.getElementById('playerNameInput');
    const enterBtn = document.getElementById('enterGameBtn');
    const scoreSpan = document.getElementById('scoreDisplay');
    const timerSpan = document.getElementById('timerDisplay');
    const messageDiv = document.getElementById('messageBox');
    const playerNameSpan = document.getElementById('playerNameSpan');
    const imageCounter = document.getElementById('imageCounter');
    const differencesLeftSpan = document.getElementById('differencesLeft');
    const playerTotalScoreSpan = document.getElementById('playerTotalScore');
    const visitorCountSpan = document.getElementById('visitorCount');
    const roomCodeDisplay = document.getElementById('roomCodeDisplay');

    roomCodeDisplay.innerText = "ØºØ±ÙØ© " + Math.floor(Math.random()*9000+1000);

    // ------------------------------------------------------
    // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù„Ø¹Ø¨Ø©
    // ------------------------------------------------------
    function generateImageUrls() {
        const urls = [];
        const baseUrls = [
            "https://i.pinimg.com/736x/e3/43/2c/e3432cfb9c3e3b0f6c0c7a3e0e3c0b0c.jpg",
            "https://i.pinimg.com/736x/8a/1b/4c/8a1b4c0b3a5f2d1e6c7a8b9c0d1e2f3a.jpg"
        ];
        for(let i=0;i<200;i++){
            const diffCount = i<50?5:(i<120?6:7);
            urls.push({
                id:i+1,
                leftImage:baseUrls[i%baseUrls.length],
                rightImage:baseUrls[i%baseUrls.length],
                differencesCount: diffCount,
                differences: generateDifferences(diffCount,i)
            });
        }
        return urls;
    }

    function generateDifferences(count, seed){
        const diffs = [], positions=[[0.15,0.20],[0.45,0.35],[0.70,0.55]];
        for(let i=0;i<count;i++){
            const pos=positions[i%positions.length];
            diffs.push({x:pos[0],y:pos[1],r:12,found:false});
        }
        return diffs;
    }

    function loadLevel(levelIndex){
        currentLevel = levelIndex%TOTAL_IMAGES;
        const level = levels[currentLevel];
        imageCounter.innerText=`${currentLevel+1}/${TOTAL_IMAGES}`;
        leftImage.src=level.leftImage;
        rightImage.src=level.rightImage;
        foundDiffCount=0;
        differencesLeftSpan.innerText=level.differencesCount;
    }

    function startTimer(){
        clearInterval(timerIntervalId);
        timeSeconds=20;
        timerIntervalId=setInterval(()=>{
            if(gameActive&&!gamePaused){
                timeSeconds--;
                timerSpan.innerText=`0:${timeSeconds<10?'0':''}${timeSeconds}`;
                if(timeSeconds<=0) endLevel(false);
            }
        },1000);
    }

    function startGame(){
        const name=nameInput.value.trim();
        if(!name){ alert('âŒ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ÙØ§Ø±ØºØ§Ù‹'); return; }
        playerName=name;
        playerNameSpan.innerText=name;
        gameActive=true;
        currentScore=0;
        scoreSpan.innerText='0';
        currentLevel=Math.floor(Math.random()*TOTAL_IMAGES);
        loadLevel(currentLevel);
        startTimer();
        messageDiv.innerText=`ğŸ”¥ Ø§Ù„Ù„Ø¹Ø¨ Ù†Ø´Ø·! Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø§Ø®ØªÙ„Ø§ÙØ§Øª ÙŠØ§ ${name}`;
    }

    function endLevel(won){
        clearInterval(timerIntervalId);
        messageDiv.innerText=won?"ğŸ‰ ÙˆØ¬Ø¯Øª ÙƒÙ„ Ø§Ù„Ø§Ø®ØªÙ„Ø§ÙØ§Øª!":"â° Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!";
        nextRoundTimeout=setTimeout(()=>{
            loadLevel(currentLevel+1);
            gameActive=true;
            startTimer();
        },5000);
    }

    // ------------------------------------------------------
    // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ·
    // ------------------------------------------------------
    leftImage.addEventListener('click',startGame);
    rightImage.addEventListener('click',startGame);
    enterBtn.addEventListener('click',startGame);

    // ------------------------------------------------------
    // POLO Login Button
    // ------------------------------------------------------
    function enterPolo(){
        const name = document.getElementById("poloPlayerName").value.trim();
        const password = document.getElementById("poloPassword").value.trim();
        const errorEl = document.getElementById("poloError");
        errorEl.innerText="";

        if(password!=="POLO FAMILY"){
            errorEl.innerText="âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©";
            return;
        }
        if(!name){
            errorEl.innerText="âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…";
            return;
        }

        playerName=name;
        document.getElementById("playerNameInput").value=name;
        playerNameSpan.innerText=name;
        document.getElementById("poloLoginPage").style.display="none";
        document.getElementById("mainGame").style.display="flex";
    }

    document.getElementById("poloEnterBtn").addEventListener("click", enterPolo);

</script>
</body>
</html>
